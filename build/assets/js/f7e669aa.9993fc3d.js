(self.webpackChunkopentezos=self.webpackChunkopentezos||[]).push([[8844],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return p},kt:function(){return h}});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),l=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=l(e.components);return r.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),f=l(a),h=n,m=f["".concat(s,".").concat(h)]||f[h]||d[h]||o;return a?r.createElement(m,i(i({ref:t},p),{},{components:a})):r.createElement(m,i({ref:t},p))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=f;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:n,i[1]=c;for(var l=2;l<o;l++)i[l]=a[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}f.displayName="MDXCreateElement"},6458:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return i},metadata:function(){return c},toc:function(){return s},default:function(){return p}});var r=a(2122),n=a(9756),o=(a(7294),a(3905)),i={id:"oracles",title:"On-chain Oracles",author:"Aymeric Bethencourt"},c={unversionedId:"defi/oracles",id:"defi/oracles",isDocsHomePage:!1,title:"On-chain Oracles",description:"Definition",source:"@site/docs/defi/oracles.md",sourceDirName:"defi",slug:"/defi/oracles",permalink:"/defi/oracles",editUrl:"https://github.com/octo-technology/OpenTezos/tree/main/docs/defi/oracles.md",version:"current",lastUpdatedBy:"Theotime-Akeare",lastUpdatedAt:1623079225,formattedLastUpdatedAt:"6/7/2021",frontMatter:{id:"oracles",title:"On-chain Oracles",author:"Aymeric Bethencourt"},sidebar:"docs",previous:{title:"Cross-chain Swaps",permalink:"/defi/cross-chain-swaps"},next:{title:"Stablecoins",permalink:"/defi/stablecoins"}},s=[{value:"Definition",id:"definition",children:[]},{value:"How it works",id:"how-it-works",children:[]},{value:"Aggregators",id:"aggregators",children:[]},{value:"Oracles on Tezos",id:"oracles-on-tezos",children:[]},{value:"References",id:"references",children:[]}],l={toc:s};function p(e){var t=e.components,i=(0,n.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,r.Z)({},l,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"definition"},"Definition"),(0,o.kt)("p",null,"With the rise of DeFi apps, the need to get trusted pricing data has grown substantially. The only issue is that a Tezos smart contract cannot, by default, receive any data from outside the blockchain. ",(0,o.kt)("strong",{parentName:"p"},"Oracles"),", therefore, offer a way to obtain data from off-chain sources and to make it available on-chain. "),(0,o.kt)("p",null,(0,o.kt)("img",{src:a(7883).Z})),(0,o.kt)("small",{className:"figure"},"FIGURE 1: Illustration of an oracle providing online data to a smart contract."),(0,o.kt)("h2",{id:"how-it-works"},"How it works"),(0,o.kt)("p",null,"An oracle is made of multiple pieces of software, both on-chain, and off-chain."),(0,o.kt)("p",null,(0,o.kt)("img",{src:a(9712).Z})),(0,o.kt)("small",{className:"figure"},"FIGURE 2: Data flow of an oracle request. In blue are on-chain entities and in purple are off-chain entities."),(0,o.kt)("p",null,"When in need of off-chain data, your smart contract will call the  ",(0,o.kt)("strong",{parentName:"p"},"oracle smart contract")," with an API URL to be fetched. The oracle smart contract will emit an ",(0,o.kt)("strong",{parentName:"p"},"event")," that can be detected by an off-chain architecture connected to a blockchain node. Typically an ",(0,o.kt)("strong",{parentName:"p"},"oracle node")," will pick up such event and process it to create a ",(0,o.kt)("strong",{parentName:"p"},"web service request"),". For simple HTTP API requests, the oracle node can fetch the data itself. But, for more complex tasks or requests, an ",(0,o.kt)("em",{parentName:"p"},"adapter")," might be needed. An adapter is simply software running on a server capable of executing complex tasks. Oracle nodes have a set of pre-determined available operations, e.g., fetch an API, parse a string, generate a random number, etc. Anything out of these simple operations will require a developer to code an adapter, tailored, to the specific needs. In this case, the adapter will fetch the external API, make operations on it, and then send back the data in serialized format (typically in JSON) to the oracle node. As the oracle node is connected to a blockchain node, it can send data to the oracle smart contract. The user smart contract can then retrieve the data from the oracle smart contract."),(0,o.kt)("p",null,"Fig. 2 represents the complete data flow. To learn more, you can ",(0,o.kt)("a",{parentName:"p",href:"https://arxiv.org/pdf/2004.07140.pdf"},"check out this white paper"),". Note that this is one way to implement oracles, there are multiple other ways with different features ",(0,o.kt)("a",{parentName:"p",href:"/defi/oracles#references"},"[5]"),"."),(0,o.kt)("h2",{id:"aggregators"},"Aggregators"),(0,o.kt)("p",null,"Oracles can aggregate data from multiple sources to guarantee the quality of the data. For instance, consider a decentralized application (Dapp) that needs the exchange rate of XTZ/BTC to perform a trading operation. The smart contract has to contact an oracle that can provide such information to get the exchange rate. The oracle can, for instance, fetch the exchange rate from ",(0,o.kt)("em",{parentName:"p"},"Binance")," and offer it, as is to the smart contract. However, if ",(0,o.kt)("em",{parentName:"p"},"Binance")," gets hacked, the Dapp would be compromised as well. To prevent this, an oracle can fetch price information from multiple sources. e.g., ",(0,o.kt)("em",{parentName:"p"},"Binance"),", ",(0,o.kt)("em",{parentName:"p"},"CoinMarketCap"),", ",(0,o.kt)("em",{parentName:"p"},"Dexter")," and ",(0,o.kt)("em",{parentName:"p"},"Quipuswap"),", then compute the median and exclude outliers (prices that are too far from the others are likely from a compromised source). The chances that all four sources are compromised at the same time becomes increasingly improbable. The price provided to the Dapp is therefore very trustworthy and can be used for financially critical operations. Notice also that price feeds can be signed in order to guarantee the source of the data."),(0,o.kt)("p",null,(0,o.kt)("img",{src:a(2030).Z})),(0,o.kt)("small",{className:"figure"},"FIGURE 3: Illustration of an oracle filtering outliers."),(0,o.kt)("p",null,"Note that Oracles are not limited to fetching price data. Any online API can be called on by an Oracle, e.g., payment data (Paypal, VISA), bank data, air traffic schedules, IoT data, weather forecasts, etc. Some applications even provide on-chain insurances, based entirely on real-world data fetched by oracles."),(0,o.kt)("h2",{id:"oracles-on-tezos"},"Oracles on Tezos"),(0,o.kt)("p",null,"On Tezos, ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tacoinfra/harbinger"},"Harbinger oracles")," provide this service as well as ",(0,o.kt)("a",{parentName:"p",href:"https://www.kaiko.com/"},"Kaiko"),". A ",(0,o.kt)("a",{parentName:"p",href:"https://www.coindesk.com/tezos-blockchain-chainlink-oracle-services"},"Chainlink integration")," is expected soon by the ",(0,o.kt)("em",{parentName:"p"},"SmartPy")," team. "),(0,o.kt)("h2",{id:"references"},"References"),(0,o.kt)("p",null,"[1]"," ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tacoinfra/harbinger"},"https://github.com/tacoinfra/harbinger")),(0,o.kt)("p",null,"[2]"," ",(0,o.kt)("a",{parentName:"p",href:"https://medium.com/@Blockscale/introducing-harbinger-a-self-sustaining-price-oracle-for-tezos-7cab5c9971d"},"https://medium.com/@Blockscale/introducing-harbinger-a-self-sustaining-price-oracle-for-tezos-7cab5c9971d")),(0,o.kt)("p",null,"[3]"," ",(0,o.kt)("a",{parentName:"p",href:"https://www.kaiko.com/"},"https://www.kaiko.com/")),(0,o.kt)("p",null,"[4]"," ",(0,o.kt)("a",{parentName:"p",href:"https://arxiv.org/pdf/2004.07140.pdf"},"https://arxiv.org/pdf/2004.07140.pdf")),(0,o.kt)("p",null,"[5]"," ",(0,o.kt)("a",{parentName:"p",href:"https://medium.com/fabric-ventures/decentralised-oracles-a-comprehensive-overview-d3168b9a8841"},"https://medium.com/fabric-ventures/decentralised-oracles-a-comprehensive-overview-d3168b9a8841")))}p.isMDXComponent=!0},2030:function(e,t,a){"use strict";t.Z=a.p+"assets/images/oracle-filter-3dfb56ad0445a24f113eba05ac392a54.svg"},9712:function(e,t,a){"use strict";t.Z=a.p+"assets/images/oracle-on-off-bad6834d7f2796c338e861004d25d867.svg"},7883:function(e,t,a){"use strict";t.Z=a.p+"assets/images/oracles-197eef37014011da17ad824389f1eb53.svg"}}]);