(self.webpackChunkopentezos=self.webpackChunkopentezos||[]).push([[6232],{3905:function(t,e,a){"use strict";a.d(e,{Zo:function(){return m},kt:function(){return d}});var n=a(7294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function s(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},o=Object.keys(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var l=n.createContext({}),c=function(t){var e=n.useContext(l),a=e;return t&&(a="function"==typeof t?t(e):i(i({},e),t)),a},m=function(t){var e=c(t.components);return n.createElement(l.Provider,{value:e},t.children)},p={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},u=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,o=t.originalType,l=t.parentName,m=s(t,["components","mdxType","originalType","parentName"]),u=c(a),d=r,h=u["".concat(l,".").concat(d)]||u[d]||p[d]||o;return a?n.createElement(h,i(i({ref:e},m),{},{components:a})):n.createElement(h,i({ref:e},m))}));function d(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var o=a.length,i=new Array(o);i[0]=u;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=t,s.mdxType="string"==typeof t?t:r,i[1]=s;for(var c=2;c<o;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},8840:function(t,e,a){"use strict";a.r(e),a.d(e,{frontMatter:function(){return s},metadata:function(){return l},toc:function(){return c},default:function(){return u}});var n,r=a(2122),o=a(9756),i=(a(7294),a(3905)),s={id:"introduction",title:"Introduction",slug:"/smartpy",authors:"Maxime Sallerin"},l={unversionedId:"smartpy/introduction",id:"smartpy/introduction",isDocsHomePage:!1,title:"Introduction",description:"This module aim to enable developers to write smart contracts with SmartPy. It will take the form of a pedagogical course, illustrated through an example of a smart contract, to help the developer acquire the essentials to write, test, and analyze his smart contract.",source:"@site/docs/smartpy/introduction.md",sourceDirName:"smartpy",slug:"/smartpy",permalink:"/smartpy",editUrl:"https://github.com/octo-technology/OpenTezos/tree/main/docs/smartpy/introduction.md",version:"current",lastUpdatedBy:"Aymeric BETHENCOURT",lastUpdatedAt:1622492989,formattedLastUpdatedAt:"5/31/2021",frontMatter:{id:"introduction",title:"Introduction",slug:"/smartpy",authors:"Maxime Sallerin"},sidebar:"docs",previous:{title:"Exam",permalink:"/explorer/exam"},next:{title:"Installation",permalink:"/smartpy/installation"}},c=[{value:"A few definitions",id:"a-few-definitions",children:[]},{value:"What is a smart contract?",id:"what-is-a-smart-contract",children:[{value:"Storage",id:"storage",children:[]},{value:"Entrypoints",id:"entrypoints",children:[]}]},{value:"References",id:"references",children:[]}],m=(n="NotificationBar",function(t){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)}),p={toc:c};function u(t){var e=t.components,n=(0,o.Z)(t,["components"]);return(0,i.kt)("wrapper",(0,r.Z)({},p,n,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"This module aim to enable developers to write smart contracts with ",(0,i.kt)("em",{parentName:"p"},"SmartPy"),". It will take the form of a pedagogical course, illustrated through an example of a smart contract, to help the developer acquire the essentials to write, test, and analyze his smart contract."),(0,i.kt)("p",null,"Tezos smart contracts are written in ",(0,i.kt)("a",{parentName:"p",href:"https://opentezos.com/michelson"},"Michelson"),", which is a stack-based language, that forms the lowest level of a Tezos smart contract. The Michelson code is what will be deployed on the Tezos network. However, while reading or writing a Michelson code is accessible for small smart contracts, it can become pretty tedious and complicated to use, for more complex smart contracts, as:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"there are no variables nor functions"),(0,i.kt)("li",{parentName:"ul"},"no syntactic sugar",(0,i.kt)("blockquote",{parentName:"li"},(0,i.kt)("p",{parentName:"blockquote"},"In computer science, ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Syntactic_sugar"},"syntactic sugar"),"  is a syntax within a programming language that is designed to make things easier to read or express."))),(0,i.kt)("li",{parentName:"ul"},"the Michelson code cannot be broken down into several files"),(0,i.kt)("li",{parentName:"ul"},"stack-based languages are not commonly used when it comes to web development.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"SmartPy solves these issues.")),(0,i.kt)("p",null,"SmartPy is a high-level smart contracts library, it comes with numerous tools in the form of ",(0,i.kt)("a",{parentName:"p",href:"https://smartpy.io/"},"SmartPy.io")," to greatly ease the accessibility, understandability and provability of smart contracts on Tezos. A few of the main advantages are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"It is based on a popular programming language: ",(0,i.kt)("em",{parentName:"li"},"Python")),(0,i.kt)("li",{parentName:"ul"},"It has a set of high-level primitives, called ",(0,i.kt)("em",{parentName:"li"},"SmartML"),", written in ",(0,i.kt)("em",{parentName:"li"},"OCaml")," for new smart contracts virtual-machine that can be compiled into Michelson. These primitives also exist on their own and can be executed, simulated and analyzed.",(0,i.kt)("blockquote",{parentName:"li"},(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"OCaml")," is an industrial-level programming language, that supports functional, imperative, and object-oriented styles.\nSmart contracts in SmartML are abstract syntax trees, as it is normally done in OCaml, with values, expressions, commands, etc."))),(0,i.kt)("li",{parentName:"ul"},"It has a compiler that translates ",(0,i.kt)("em",{parentName:"li"},"SmartML")," contracts into ",(0,i.kt)("em",{parentName:"li"},"Michelson"),"."),(0,i.kt)("li",{parentName:"ul"},"Analytics tools are elements of SmartPy that provide some automatic procedures to analyze and prove the properties of smart contracts. Such as the ",(0,i.kt)("a",{parentName:"li",href:"https://smartpy.io/ide"},"user interface")," which brings simulation, debugging, tests, and analytics capabilities straight to developers.")),(0,i.kt)("p",null,(0,i.kt)("img",{src:a(3132).Z})),(0,i.kt)("small",{className:"figure"},"FIGURE 1: From SmartPy to Michelson, Tests, and Analytics "),(0,i.kt)("p",null,"Once built, SmartPy contracts become ",(0,i.kt)("em",{parentName:"p"},"SmartML")," contracts and are handled in an OCaml library called ",(0,i.kt)("em",{parentName:"p"},"SmartEngine"),"."),(0,i.kt)("p",null,"The Python interpreter then evaluates Python code containing SmartPy definitions. It creates a very simple expression, called an S-expression, that is parsed and typed while some properties are verified in the SmartEngine backend."),(0,i.kt)("p",null,"The S-expression sent between SmartPy and SmartML has the following form, which is not supposed to be human-readable."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'(storage (record (claimed (bool False)) (deck (array "int" (int 1)\n(int 2) (int 3) (int 4) (int 5))) (nextPlayer (int 1)) (size (int\n5)) (winner (int 0))) messages ((claim ((check (eq (sum (attrData\n"deck")) (int 0))) (set (attrData "claimed") (bool True)) (set\n(attrData "winner") (attrData "nextPlayer")))) (remove ((define\n"cell" (unknown 1)) (define "k" (unknown 2)) (check (ge (getParam\ncell (unknown 1)) (int 0))) (check (lt (getParam cell (unknown 1))\n(attrData "size"))) (check (ge (getParam k (unknown 2)) (int 1)))\n(check (le (getParam k (unknown 2)) (int 2))) (check (le (getParam\nk (unknown 2)) (getItem (attrData "deck") (getParam cell (unknown\n1))))) (set (getItem (attrData "deck") (getParam cell (unknown 1)))\n(sub (getItem (attrData "deck") (getParam cell (unknown 1)))\n(getParam k (unknown 2)))) (set (attrData "nextPlayer") (sub (int 3)\n(attrData "nextPlayer")))))))\n')),(0,i.kt)("p",null,"This design aim to apply the same methodology to building this kind of simple S-expression for other languages and be able to use things like SmartJS instead of SmartPy, etc."),(0,i.kt)("p",null,"It can then be easily compiled into a single Michelson code file.",(0,i.kt)("br",{parentName:"p"}),"\n","This Michelson file is the smart contract that will be deployed on a Tezos network."),(0,i.kt)("h2",{id:"a-few-definitions"},"A few definitions"),(0,i.kt)("h2",{id:"what-is-a-smart-contract"},"What is a smart contract?"),(0,i.kt)("p",null,"What a smart contract is and what role ",(0,i.kt)("em",{parentName:"p"},"SmartPy")," plays in it."),(0,i.kt)("p",null,"Fig. 1 helps to contextualize the role of ",(0,i.kt)("em",{parentName:"p"},"SmartPy")," in the Tezos ecosystem."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"SmartPy")," is a development tool allowing for the production of smart contracts (scripts in Michelson), which can be deployed on the blockchain."),(0,i.kt)("p",null,(0,i.kt)("img",{src:a(8157).Z})),(0,i.kt)("small",{className:"figure"},"FIGURE 2: SmartPy contextualisation "),(0,i.kt)("p",null,"A Tezos smart contract is a piece of ",(0,i.kt)("strong",{parentName:"p"},"code")," written in Michelson language (a low-level stack-based Turing-complete language)."),(0,i.kt)("p",null,"It defines all ",(0,i.kt)("strong",{parentName:"p"},"entrypoints")," (invocable functions) of the smart contract and its ",(0,i.kt)("strong",{parentName:"p"},"storage"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{src:a(9511).Z})),(0,i.kt)("small",{className:"figure"},"FIGURE 3: Smart contract"),(0,i.kt)("h3",{id:"storage"},"Storage"),(0,i.kt)("p",null,"The storage is an allocated memory space associated with a smart contract. It is the permanent data store for the smart contract."),(0,i.kt)("h3",{id:"entrypoints"},"Entrypoints"),(0,i.kt)("p",null,"The entrypoints are the invocable functions of a smart contract. Executing an entrypoint takes some parameters and the current-state of the storage. This action will return a new modified storage and some operations."),(0,i.kt)(m,{mdxType:"NotificationBar"},(0,i.kt)("p",null,(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Operations")," are an ordered list of transactions. An operation can trigger a tez transfer or the entry point of another targeted contract. If the execution of an entry point produces operations then they are sent and executed in the order stated by the list of operations."))),(0,i.kt)("p",null,"In the rest of the module, we will see how to install SmartPy on his machine. But mainly, we will see how to use ",(0,i.kt)("a",{parentName:"p",href:"https://smartpy.io/ide"},"the online editor")," to start directly to code, test, and run his smart contract with SmartPy. The whole will be illustrated with an example of a raffle smart contract."),(0,i.kt)("h2",{id:"references"},"References"),(0,i.kt)("p",null,"[1]"," ",(0,i.kt)("a",{parentName:"p",href:"https://tzstats.com/blog/next-gen-blockchain-indexing-for-tezos/https://smartpy.io/"},"https://tzstats.com/blog/next-gen-blockchain-indexing-for-tezos/https://smartpy.io/")),(0,i.kt)("p",null,"[2]"," ",(0,i.kt)("a",{parentName:"p",href:"https://smartpy-io.medium.com/introducing-smartpy-and-smartpy-io-d4013bee7d4e"},"https://smartpy-io.medium.com/introducing-smartpy-and-smartpy-io-d4013bee7d4e")))}u.isMDXComponent=!0},8157:function(t,e,a){"use strict";e.Z=a.p+"assets/images/intro_schema-93d62e83c79e9504eec5950fc06cf889.svg"},9511:function(t,e,a){"use strict";e.Z=a.p+"assets/images/smart_contract-60cf30eef28cd3097505d46992b28ced.svg"},3132:function(t,e,a){"use strict";e.Z=a.p+"assets/images/smartpy_intro-80764d6928d6d603ce4b125a5fc1ac0a.svg"}}]);