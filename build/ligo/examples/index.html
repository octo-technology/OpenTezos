<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="OpenTezos Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="OpenTezos Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Examples | OpenTezos</title><meta data-react-helmet="true" property="og:url" content="https://opentezos.com/ligo/examples"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Examples | OpenTezos"><meta data-react-helmet="true" name="description" content="Function"><meta data-react-helmet="true" property="og:description" content="Function"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://opentezos.com/ligo/examples"><link data-react-helmet="true" rel="alternate" href="https://opentezos.com/ligo/examples" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://opentezos.com/ligo/examples" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.60c2ec83.css">
<link rel="preload" href="/assets/js/runtime~main.972b4ff9.js" as="script">
<link rel="preload" href="/assets/js/main.6ca66676.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-dark.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/octo-technology/OpenTezos/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT" style="margin-left:2px">üåô</span></div><div class="react-toggle-track-x"><span class="toggle_71bT" style="margin-left:1px">‚òÄÔ∏è</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-dark.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/octo-technology/OpenTezos/" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Welcome</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/">Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/paths">Paths</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Blockchain Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics/main-properties">Main properties of the first &quot;blockchain&quot;</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics/proof-of-work">Proof-of-work</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics/other-consensuses">Introduction to other consensus algorithms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics/smart-contracts">Smart Contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tezos Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/smart-contracts">Smart contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/liquid-proof-of-stake">Liquid Proof-of-Stake</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/operations">Operations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/cli-and-rpc">CLI and RPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/governance-on-chain">Governance on-chain</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/history-of-amendments">History of amendments</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/economics-and-rewards">Economics and rewards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deploy a node</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node/set-up-a-node">Set-up a node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node/networks">What about networks?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node/to-go-further">To go further</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How to use an Explorer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/indexer-explained">How Indexers Work?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/available-tezos-indexers">Available Tezos Explorers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/tzstats-main-features">How to use the tzStats blockchain explorer?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/tzstats-smart-contract">Checkout your smart contract on TzStats</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/private-indexer">Private indexer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">SmartPy</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/smartpy">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/smartpy/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/smartpy/write-contract-smartpy">Smart contract development with SmartPy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/smartpy/exam">Exam</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">LIGO</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ligo">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/write-contracts-ligo">Smart contract development in PascaLIGO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/language-basics">Language basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/deploy-a-contract">Smart Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/unit-testing">Unit Testing with PyTezos</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/ligo/examples">Examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/exam">Exam</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/take-away">Take Away</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Michelson</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/michelson">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/michelson/smart-contracts">Smart Contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/michelson/tutorial">Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/michelson/examples">Examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/michelson/instructions-reference">Instructions Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/michelson/exam">Exam</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/michelson/take-away">Take away</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Build a Dapp</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/truffle_compilation_migration">Smart contract deployment with Truffle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/taquito">Taquito</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/temple">Temple Wallet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/basics">Build a dapp - basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/front_user_experience">Build a dapp - User Experience</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Baking</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baking">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baking/baking_explained">How baking works?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baking/reward">Rewards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baking/bakers_list">List of bakers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baking/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deploy Bakers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baker">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baker/cli-baker">CLI to become a baker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baker/delegating">Delegating</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baker/voting">Voting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baker/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">DeFi</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/token-standards">Token Standards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/dexs">Decentralized Exchanges</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/wrapped-assets">Wrapped Assets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/cross-chain-swaps">Cross-chain Swaps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/oracles">On-chain Oracles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/stablecoins">Stablecoins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/synthetics">Synthetics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/lending">Lending and Flash Loans</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Formal Verification</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/formal-verification">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/formal-verification/gadt-coq">Coq, GADT and Mi-Cho-Coq</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/formal-verification/modeling-theorem">Formal verification on smart contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/formal-verification/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Private Blockchain</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/private">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/private/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How to contribute</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/report-issue">Report an issue</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/opentezos">Contribute to OpenTezos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/tezos-core">Contribute to the Tezos Core Protocol</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/grant">Receive a grant</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/baker">Become a baker or a delegator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/exam">Exam</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Examples</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="function"></a>Function<a class="hash-link" href="#function" title="Direct link to heading">#</a></h2><p>The example below comes from <a href="https://tezosacademy.io/pascal/chapter-functions" target="_blank" rel="noopener noreferrer">Tezos Academy</a>
and represents a modification of the id of a &#x27;spaceship&#x27;.</p><p>So the following function takes as string <code>my_ship</code> as input,
modifies the third character to 1 and assigns the result to a constant <code>modified_ship</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type ship_code is string</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">var</span><span class="token plain"> my_ship </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> ship_code </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token string">&quot;020433&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">modify_ship_code</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> my_ship </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> ship_code</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> ship_code is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> modified_ship </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(227, 98, 9)">String</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">sub</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token number">0n</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">2n</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> my_ship</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">^</span><span class="token plain"> </span><span class="token string">&quot;1&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">^</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(227, 98, 9)">String</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">sub</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token number">3n</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">3n</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> my_ship</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> modified_ship</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You can call the function <code>modify_ship_code</code> defined above by using LIGO compiler, like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo run-function function_example.ligo modify_ship_code </span><span class="token string">&#x27;020433&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Outputs: &#x27;021433&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="record"></a>Record<a class="hash-link" href="#record" title="Direct link to heading">#</a></h2><p>The structured type <code>record</code> is here, used to define the coordinates of a planet in the solar system.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type coordinates is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    record </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        x </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> int</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        y </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> int</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        z </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> int</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">var</span><span class="token plain"> earth_coordinates </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> coordinates </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    record </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        x </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        y </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token number">7</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        z </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">patch earth_coordinates </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> record </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">z </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token number">5</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>A <code>patch with</code> instruction takes a <code>record</code> data structure to be updated,
and (a record with) a subset of the fields to update,
then modifies the recorded data structure in accordance with the new specified subset of fields.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="main-function"></a>Main function<a class="hash-link" href="#main-function" title="Direct link to heading">#</a></h2><p>In LIGO, the design aims to have one main function called main,
which dispatches the control flow according to its parameter.
The functions used for those actions are called entrypoints.</p><p>In the example below:</p><ul><li>The functions <code>set_ship_code</code> and <code>go_to</code> are the entrypoints.</li><li><code>Set_ship_code</code> and <code>Go_to</code> are the associated actions.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type parameter is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token maybe-class-name">Set_ship_code</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> string</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token maybe-class-name">Go_to</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> string</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type storage is record </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  ship_code </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  destination </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> string</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> is </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> storage</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">set_ship_code</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> input_string </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> string</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> store </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> storage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">is</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> record </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">ship_code </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> input_string</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">go_to</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> input_string </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> string</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> store </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> storage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">is</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> record </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">destination </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> input_string</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">main</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> action </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> parameter</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> store </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> storage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> action </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Set_ship_code</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">input_string</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">set_ship_code</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">input_string</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Go_to</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">input_string</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">go_to</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">input_string</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="option"></a>Option<a class="hash-link" href="#option" title="Direct link to heading">#</a></h2><p>The example below comes from <a href="https://tezosacademy.io/pascal/chapter-option" target="_blank" rel="noopener noreferrer">Tezos Academy</a>
and deals with the modification of the weapon power of a spaceship to illustrate the use of option types.</p><p>In the code below, we can notice that the <em>weapons</em> variable are defined as a mapping between the name of each weapon and its corresponding input of power.
Here, we want to increase the power of the Main Laser but mapping the returns optional results as they might not be found in the mapping.
So we define the constant <code>main_laser_power</code> as an optional <code>int</code> by selecting &quot;Main Laser&quot; from the weapons mapping.</p><p>Then we write a pattern matching the <code>main_laser_power</code>.</p><ul><li>If it exists, it increases the power of the &quot;Main Laser&quot; by 1 (use i as a temporary matching variable).  </li><li>If it does not exist in the mapping, it will fail with &quot;Weapon not found&quot;.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type weapon_power is </span><span class="token function" style="color:rgb(111, 66, 193)">map</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> int</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">main</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> p </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> unit</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> store </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> weapons </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> weapon_power </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        map </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token string">&quot;Main Laser&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token number">5</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token string">&quot;Right Laser&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token string">&quot;Left Laser&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> main_laser_power </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">option</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> weapons</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&quot;Main Laser&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> main_laser_power </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Some</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> weapons</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&quot;Main Laser&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 92, 197)">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token maybe-class-name">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">failwith</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;Weapon not found&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    end</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="full-example---fundadvisor"></a>Full example - FundAdvisor<a class="hash-link" href="#full-example---fundadvisor" title="Direct link to heading">#</a></h1><p>This example is meant to illustrate the communication between contracts (with get_entrypoint_opt LIGO function)
and lambda patterns allows you to modify a contract that is already deployed.
It deals with implementing, deploying and interacting with Tezos smart contracts.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="the-fund-and-its-advisor"></a>The Fund and its advisor<a class="hash-link" href="#the-fund-and-its-advisor" title="Direct link to heading">#</a></h2><p>The <code>indice</code> contract represents a fund value,
and the <code>advisor</code> contract gives an advice on investing in this fund.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="transaction-workflow"></a>Transaction workflow<a class="hash-link" href="#transaction-workflow" title="Direct link to heading">#</a></h3><p>The <code>advisor</code> contract can be invoked to request the fund value to the <code>indice</code> contract (via a transaction).
The <code>indice</code> contract receives the request (transaction)
and will sends back the requested value.
When the <code>advisor</code> contract receives the fund value, it can apply the &quot;algorithm&quot; to check if it is worth investing!</p><br><p><img src="/assets/images/schema_fundadvisor-b6d50a4e86ff1c9a8f46d398e6ef59cc.svg"></p><small class="figure">FIGURE 1: FundAdvisor</small><p>The resulting advice is stored in the storage (in the result field).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="lambda-pattern"></a>Lambda pattern<a class="hash-link" href="#lambda-pattern" title="Direct link to heading">#</a></h3><p>The real business logic of the <code>advisor</code> smart contract lies in the lambda function, which is defined in the storage.
The storage is certified to be modified so as for the business logic (lambda).</p><p>So an entrypoint with <code>ChangeAlgorithm</code> is provided to modify the algorithm that computes the worth of the investment.</p><blockquote><p><strong>Lambda pattern</strong><br>
Changing the behaviour of a smart contract can be done by customizing its implementation through the lambda functions.
The idea is to implement the smart contract logic in a lambda function that can be modified after the contract is deployed.<br>
Find out more about lambda <a href="https://tezosacademy.io/pascal/chapter-lambda" target="_blank" rel="noopener noreferrer">here</a>.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="requirement"></a>Requirement<a class="hash-link" href="#requirement" title="Direct link to heading">#</a></h2><ol><li>Having a LIGO Compiler, and a code editor installed.
If not, go <a href="https://opentezos.com/ligo/installation" target="_blank" rel="noopener noreferrer">here</a>.</li><li>Having a sandboxed mode ready.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sandboxed-mode"></a>Sandboxed mode<a class="hash-link" href="#sandboxed-mode" title="Direct link to heading">#</a></h2><p>This part will explain to you how to run a &#x27;localhost-only&#x27; instance of a Tezos network.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="run-a-sandboxed-node"></a>Run a sandboxed node<a class="hash-link" href="#run-a-sandboxed-node" title="Direct link to heading">#</a></h3><p>For instance, if you want to run a local network with two nodes, in the first terminal,
the following command will initialize a node listening for peers on port 19731 and
listening for RPC on port 18731.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">./src/bin_node/tezos-sandboxed-node.sh </span><span class="token number">1</span><span class="token plain"> --connections </span><span class="token number">1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To launch the second node, run the following command in another terminal,
and it will listen to port 19739 and 18739:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">./src/bin_node/tezos-sandboxed-node.sh </span><span class="token number">9</span><span class="token plain"> --connections </span><span class="token number">1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="use-the-sandboxed-client"></a>Use the sandboxed client<a class="hash-link" href="#use-the-sandboxed-client" title="Direct link to heading">#</a></h3><p>Once your node is running, open a new terminal
and initialize the ‚Äúsandboxed‚Äù client data in a temporary directory:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token builtin class-name" style="color:rgb(227, 98, 9)">eval</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">`</span><span class="token variable" style="color:rgb(156, 220, 254)">./src/bin_client/tezos-init-sandboxed-client.sh </span><span class="token variable number" style="color:rgb(156, 220, 254)">1</span><span class="token variable" style="color:rgb(156, 220, 254)">`</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="activate-a-protocol"></a>Activate a protocol<a class="hash-link" href="#activate-a-protocol" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-activate-alpha</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>Find out more about sandboxed mode <a href="https://tezos.gitlab.io/user/sandbox.html" target="_blank" rel="noopener noreferrer">here</a></p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="first-contract---indice"></a>First contract - Indice<a class="hash-link" href="#first-contract---indice" title="Direct link to heading">#</a></h2><p>The indice contract represents a fund value.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="defining-storage-and-entrypoints"></a>Defining storage and entrypoints<a class="hash-link" href="#defining-storage-and-entrypoints" title="Direct link to heading">#</a></h3><p>Let&#x27;s create an <code>indice_types.ligo</code> file to put all the needed type definitions.</p><ul><li><code>indiceStorage</code> is an integer type that can have the value of an equity.</li><li><code>indiceEntrypoints</code> determine how the contract will be invoked:<ul><li>By increasing the value of the contract storage by using <code>Increment of int</code>.</li><li>By decreasing it with <code>Decrement of int</code>.</li><li>By sending its value to another contract that has called it, using <code>SendValue of unit</code>.</li></ul></li><li><code>indiceFullReturn</code>that determines the return type of the main function.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">// indice_types.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type indiceStorage is int</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type indiceEntrypoints is </span><span class="token maybe-class-name">Increment</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> int </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token maybe-class-name">Decrement</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> int </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token maybe-class-name">SendValue</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> unit</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type indiceFullReturn is </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> indiceStorage</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>Note that the <code>sendValue</code> entrypoint does not take any parameter.</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="defining-the-main-function"></a>Defining the main function<a class="hash-link" href="#defining-the-main-function" title="Direct link to heading">#</a></h3><p>Now let&#x27;s move to another file <code>indice.ligo</code>
that will include the previous file <code>indice_types.ligo</code>
and create the main function <code>indiceMain</code>
with writing <code>#include &quot;indice_types.ligo&quot;</code> at the beginning of the script.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">// indice.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">#include &quot;indice_types.ligo&quot;</span><span class="token template-string template-punctuation string">`</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">indiceMain</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> ep </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceEntrypoints</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> store </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> indiceFullReturn is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> skip </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let&#x27;s keep the block empty for now and see if it compiles correctly.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-contract indice.ligo indiceMain</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This should return:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> parameter </span><span class="token function" style="color:rgb(111, 66, 193)">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">decrement</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">increment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">sendValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  storage int </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  code </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">CDR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">NIL</span><span class="token plain"> operation </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Now let&#x27;s implement the three entrypoints:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">// indice.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">#include &quot;indice_types.ligo&quot;</span><span class="token template-string template-punctuation string">`</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">indiceMain</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> ep </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceEntrypoints</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> store </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> indiceFullReturn is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> ret </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> indiceFullReturn </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> ep </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Increment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">increment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Decrement</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">decrement</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">SendValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">sendValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    end</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> ret</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="defining-the-entrypoints"></a>Defining the entrypoints<a class="hash-link" href="#defining-the-entrypoints" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="increment"></a>Increment<a class="hash-link" href="#increment" title="Direct link to heading">#</a></h4><p><code>increment</code> function takes two parameters:</p><ul><li><code>param</code> of type <code>int</code> which is the value that will be added to the storage.</li><li><code>s</code> the initial value of the storage.</li></ul><p>This function&#x27;s return type is <code>indiceFullReturn</code> and returns:</p><ul><li>an empty list of operations.</li><li>a modified storage with a new value of <code>s + param</code>.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">//indice.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">increment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> param </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> int</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> indiceFullReturn is </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> skip </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 92, 197)">+</span><span class="token plain"> param</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="decrement"></a>Decrement<a class="hash-link" href="#decrement" title="Direct link to heading">#</a></h4><p>The <code>decrement</code> function takes two parameters:</p><ul><li><code>param</code> of type <code>int</code> which is the value that will be removed from the storage.</li><li><code>s</code> the initial value of the storage.</li></ul><p>This function&#x27;s return type is <code>indiceFullReturn</code> and returns:</p><ul><li>an empty list of operations.</li><li>a modified storage with a new value of <code>s - param</code>.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">//indice.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">decrement</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> param </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> int</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> indiceFullReturn is </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> skip </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token plain"> param</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sendvalue"></a>SendValue<a class="hash-link" href="#sendvalue" title="Direct link to heading">#</a></h4><p><code>sendValue</code> function takes two parameters:</p><ul><li><code>param</code> of type <code>unit</code> which means it takes no parameter.</li><li><code>s</code> the initial value of the storage.</li></ul><p>This function return type is <code>indiceFullReturn</code> and it returns:</p><ul><li>a list of operation containing a transaction.</li><li>the initial storage that is not modified.</li></ul><p>The predefined function <code>Tezos.get_entrypoint_opt</code> can be used
to retrieve the definition of a single entry point.<br>
<code>%receiveValue</code> is the label of the entrypoint that will be defined in the advisor contract.</p><p>When the function <code>get_entrypoint_opt</code> does not find any contract
at a given <code>address</code>, or if the contract doesn&#x27;t match the type, then <code>None</code> is returned.</p><blockquote><p>Note that the <code>Tezos.get_entrypoint_opt</code> function is a two-way communication solution.
between contract that are already deployed.
Find out more on <code>Tezos.get_entrypoint_opt</code> <a href="https://tezosacademy.io/pascal/chapter-polymorphism" target="_blank" rel="noopener noreferrer">here</a>.</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">//indice.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">sendValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> param </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> unit</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> indiceFullReturn is </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> c_opt </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">option</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Tezos</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">get_entrypoint_opt</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;%receiveValue&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token maybe-class-name">Tezos</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">sender</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> receiver </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> c_opt </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Some</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> c</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token maybe-class-name">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">failwith</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;sender cannot receive indice value&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    end</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> op </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> operation </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Tezos</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">transaction</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain">mutez</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> receiver</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> txs </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> list </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"> op</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">txs</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let&#x27;s compile again the main function to be sure we made no mistakes.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-contract indice.ligo indiceMain</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="second-contract---advisor"></a>Second contract - Advisor<a class="hash-link" href="#second-contract---advisor" title="Direct link to heading">#</a></h2><p>Remember that the <code>advisor</code> contract can be invoked to request the value of the fund from the <code>indice</code> contract (via a transaction).
The <code>indice</code> contract receives the request (transaction) and will send back the requested value.
When the <code>advisor</code> contract receives the fund value, it can apply the &quot;algorithm&quot; to check that it is worth investing!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="defining-storage-and-entrypoints-1"></a>Defining storage and entrypoints<a class="hash-link" href="#defining-storage-and-entrypoints-1" title="Direct link to heading">#</a></h3><p>In a new file called <code>advisor_types.ligo</code> we define:</p><ul><li><code>advisorStorage</code> which is a record type containing three fields:<ul><li><code>indiceAddress</code> of type <code>address</code> to communicate with the indice contract.</li><li><code>algorithm</code> takes an <code>int</code> as a parameter and returns a <code>bool</code>,
depending on the business logic.</li><li><code>result</code> is <code>True</code> if the investor should invest and <code>False</code> otherwise.</li></ul></li><li><code>advisorEntrypoints</code> that determines how the contract will be invoked:<ul><li>By receiving an integer value from another contract&#x27;s storage with <code>ReceiveValue of int</code>.</li><li>By requesting this value with <code>sendValue of unit</code>. </li><li>By modifying the algorithm that computes the worth of the investment with <code>ChangeAlgorithm of advisorAlgo</code>.</li></ul></li><li><code>advisorFullReturn</code>that determines the return type of the main function.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">//advisor_types.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type advisorAlgo is int </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> bool</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type advisorStorage is record </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    indiceAddress </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> address</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    algorithm </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> advisorAlgo</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    result </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> bool</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type advisorEntrypoints is </span><span class="token maybe-class-name">ReceiveValue</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> int </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token maybe-class-name">RequestValue</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> unit </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token maybe-class-name">ChangeAlgorithm</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> advisorAlgo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type advisorFullReturn is </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> advisorStorage</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="defining-the-main-function-1"></a>Defining the main function<a class="hash-link" href="#defining-the-main-function-1" title="Direct link to heading">#</a></h3><p>Like before, let&#x27;s create another file <code>advisor.ligo</code>
that will include the previous file <code>advisor_types.ligo</code>
and create the main function <code>advisorMain</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">//advisor.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">#include </span><span class="token string">&quot;advisor_types.ligo&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">advisorMain</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> ep </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorEntrypoints</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> store </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> advisorFullReturn is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> ret </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> advisorFullReturn </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> ep </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">ReceiveValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">execute</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">RequestValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">request</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">ChangeAlgorithm</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">change</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    end</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> ret</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="defining-the-entrypoints-1"></a>Defining the entrypoints<a class="hash-link" href="#defining-the-entrypoints-1" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="receivevalue"></a>ReceiveValue<a class="hash-link" href="#receivevalue" title="Direct link to heading">#</a></h4><p>Symmetrically to the <code>SendValue</code> function defined for the indice contract,
we here, define the <code>RequestValue</code> function, so that the two-way communication can be complete.</p><p><code>request</code> function takes two parameters:</p><ul><li><code>param</code> of type <code>unit</code> which means it takes no parameter.</li><li><code>s</code> the initial value of the storage.</li></ul><p>This function return type is <code>advisorFullReturn</code> and returns:</p><ul><li>a list of operation containing a transaction.</li><li>the initial storage that is not modified.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">//advisor.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">request</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> p </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> unit</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> advisorFullReturn is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> c_opt </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">option</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Tezos</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">get_entrypoint_opt</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;%sendValue&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">indiceAddress</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> receiver </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> c_opt </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Some</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> c</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token maybe-class-name">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">failwith</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;indice cannot send its value&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    end</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> op </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> operation </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Tezos</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">transaction</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain">mutez</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> receiver</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> txs </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> list </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"> op</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">txs</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="requestvalue"></a>RequestValue<a class="hash-link" href="#requestvalue" title="Direct link to heading">#</a></h4><p><code>execute</code> function takes two parameters:</p><ul><li><code>indiceVal</code> of type <code>int</code> which is the value that will be passed in the algorithm.</li><li><code>s</code> the initial value of the storage.</li></ul><p>This function&#x27;s return type is <code>advisorFullReturn</code> and returns:</p><ul><li>an empty list of operations</li><li>a modified storage with a new value for <code>s.result</code>
that will be the boolean return of the algorithm.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">//advisor.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">execute</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> indiceVal </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> int</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> advisorFullReturn is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">result</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">algorithm</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">indiceVal</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="changealgorithm"></a>ChangeAlgorithm<a class="hash-link" href="#changealgorithm" title="Direct link to heading">#</a></h4><p><code>change</code> function takes two parameters:</p><ul><li><code>p</code> of type <code>advisorAlgo</code> which is the algorithm function corresponding to the wanted business logic.</li><li><code>s</code> the initial value of the storage.</li></ul><p>This function&#x27;s return type is <code>advisorFullReturn</code> and returns:</p><ul><li>an empty list of operations</li><li>a modified storage with a new value for <code>s.algorithm </code>.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">//advisor.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">change</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> p </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorAlgo</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> advisorFullReturn is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">algorithm</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let&#x27;s compile the main function.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-contract advisor.ligo advisorMain</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dry-run-compilation-and-deployment"></a>Dry-run, compilation and deployment<a class="hash-link" href="#dry-run-compilation-and-deployment" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="indice-contract"></a>Indice contract<a class="hash-link" href="#indice-contract" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">//indice.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">#include </span><span class="token string">&quot;indice_types.ligo&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">increment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> param </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> int</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> indiceFullReturn is </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> skip </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 92, 197)">+</span><span class="token plain"> param</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">decrement</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> param </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> int</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> indiceFullReturn is </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> skip </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token plain"> param</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">sendValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> param </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> unit</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> indiceFullReturn is </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> c_opt </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">option</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Tezos</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">get_entrypoint_opt</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;%receiveValue&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token maybe-class-name">Tezos</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">sender</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> receiver </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> c_opt </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Some</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> c</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token maybe-class-name">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">failwith</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;sender cannot receive indice value&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    end</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> op </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> operation </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Tezos</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">transaction</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain">mutez</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> receiver</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> txs </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> list </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"> op</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">txs</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">indiceMain</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> ep </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceEntrypoints</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> store </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> indiceStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> indiceFullReturn is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> ret </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> indiceFullReturn </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> ep </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Increment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">increment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Decrement</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">decrement</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">SendValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">sendValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    end</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> ret</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="simulation"></a>Simulation<a class="hash-link" href="#simulation" title="Direct link to heading">#</a></h4><p>Let&#x27;s simulate the indice contract with the increment action using <code>5</code> as a parameter and an initial storage of <code>0</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo dry-run indice.ligo indiceMain </span><span class="token string">&#x27;Increment(5)&#x27;</span><span class="token plain"> </span><span class="token string">&#x27;0&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This should return:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">LIST_EMPTY</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>As expected there is an empty list of operation, and the storage has been incremented by 5.</p><p>To be sure let&#x27;s modify the initial value of the storage to <code>4</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo dry-run indice.ligo indiceMain </span><span class="token string">&#x27;Increment(5)&#x27;</span><span class="token plain"> </span><span class="token string">&#x27;4&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This should return:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">LIST_EMPTY</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">9</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let&#x27;s simulate another entrypoint, <code>sendValue</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo dry-run indice.ligo indiceMain </span><span class="token string">&#x27;SendValue(unit)&#x27;</span><span class="token plain"> </span><span class="token string">&#x27;3&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This command should return:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token function" style="color:rgb(111, 66, 193)">failwith</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;sender cannot receive indice value&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Indeed, because the contract is not deployed yet.
This is the limit of this simulation.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="compilation"></a>Compilation<a class="hash-link" href="#compilation" title="Direct link to heading">#</a></h4><p>Now, let&#x27;s prepare the parameters and the storage.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-storage indice.ligo indiceMain </span><span class="token string">&#x27;0&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#output: 0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-parameter indice.ligo indiceMain </span><span class="token string">&#x27;Increment(5)&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#output: (Left (Right 5))</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-parameter indice.ligo indiceMain </span><span class="token string">&#x27;Decrement(5)&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#output: (Left (Left 5))</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-parameter indice.ligo indiceMain </span><span class="token string">&#x27;SendValue(unit)&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#output: (Right Unit)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p><strong>Reminder:</strong> <code>0</code>, <code>(Left (Right 5))</code>, <code>(Left (Left 5))</code>, <code>(Right Unit)</code> are Michelson expressions that
can also be used as parameter in <code>tezos-client</code> command lines.</p></blockquote><p>Once everything looks ok, we can compile the main function and save the output in an <code>indice.tz</code> file.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-contract indice.ligo indiceMain </span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> indice.tz</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This should return:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">parameter</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">decrement</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">increment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">sendValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  storage int </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  code </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">DUP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         </span><span class="token constant" style="color:rgb(100, 102, 149)">CDR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         </span><span class="token constant" style="color:rgb(100, 102, 149)">CAR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         </span><span class="token constant" style="color:rgb(100, 102, 149)">IF_LEFT</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">IF_LEFT</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">               </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SUB</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">NIL</span><span class="token plain"> operation </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">               </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">ADD</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">NIL</span><span class="token plain"> operation </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">DROP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">SENDER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">CONTRACT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">receiveValue int </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">IF_NONE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> string </span><span class="token string">&quot;sender cannot receive indice value&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">FAILWITH</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> mutez </span><span class="token number">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">DIG</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">DUP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">DUG</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">TRANSFER_TOKENS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">NIL</span><span class="token plain"> operation </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">DIG</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">CONS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="deployment"></a>Deployment<a class="hash-link" href="#deployment" title="Direct link to heading">#</a></h4><p>To display the list of deployed contracts, run the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client list known contracts</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This should return something like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">activator: tz1TGu6TN5GSez2ndXXeDX6LgUDvLzPLqgYV</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap5: tz1ddb9NMYHZi5UzPdzTZMYQQZoMub195zgv</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap3: tz1b7tUupMgCNw2cCLpKTkSD1NZzB5TkP2sv</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap2: tz1faswCTDciRzE4oJ9jn2Vm2dvjeyA9fUzU</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap1: tz1KqTpEZ7Yob7QbPE4Hy4Wo8fHG8LhKxZSx</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Note that in the sandboxed-mode there are users already created, that we can reuse later.</p><p>It&#x27;s time to deploy the indice smart contract.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client originate contract indice transferring </span><span class="token number">1</span><span class="token plain"> from bootstrap1  running </span><span class="token string">&#x27;indice.tz&#x27;</span><span class="token plain"> --init </span><span class="token string">&#x27;0&#x27;</span><span class="token plain"> --dry-run</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You should have an error message telling you to specify the gaz fee with <code>--burn-cap</code></p><p>Try again and if everything works properly run the same command without the <code>--dry-run</code> part.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client originate contract indice transferring </span><span class="token number">1</span><span class="token plain"> from bootstrap1  running </span><span class="token string">&#x27;indice.tz&#x27;</span><span class="token plain"> --init </span><span class="token string">&#x27;0&#x27;</span><span class="token plain"> --burn-cap </span><span class="token number">0.12525</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The transaction is now launched, and you should have the following response:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Node is boostrapped.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Estimated gas 2306,275 units (will add 100 + 88 for safety)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Estimated storage: 501 bytes added (will add 20 for safety)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Operation successfully injected in the node.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Operation hash is &#x27;opR766cSqn37L8qCjgcEqu4tfGeukCKBezpHjjicAYB4NYf6g2b&#x27;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Waiting for the operation to be included...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let&#x27;s open another terminal in order to bake this transaction using the following command line:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client bake </span><span class="token keyword" style="color:#e3116c">for</span><span class="token plain"> bootstrap1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p><strong>Tezos baking</strong> is the process of signing and appending a block of transactions to the Tezos blockchain.</p></blockquote><p>Now, run the command below and see your indice contract on the list!</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client list known contracts</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">indice: KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">activator: tz1TGu6TN5GSez2ndXXeDX6LgUDvLzPLqgYV</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap5: tz1ddb9NMYHZi5UzPdzTZMYQQZoMub195zgv</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap3: tz1b7tUupMgCNw2cCLpKTkSD1NZzB5TkP2sv</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap2: tz1faswCTDciRzE4oJ9jn2Vm2dvjeyA9fUzU</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap1: tz1KqTpEZ7Yob7QbPE4Hy4Wo8fHG8LhKxZSx</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Write down your indice contract address somewhere because you will need it to initialize your advisor contract.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="advisor-contract"></a>Advisor contract<a class="hash-link" href="#advisor-contract" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">//advisor.ligo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">#include </span><span class="token string">&quot;advisor_types.ligo&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">request</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> p </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> unit</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> advisorFullReturn is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> c_opt </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">option</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Tezos</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">get_entrypoint_opt</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;%sendValue&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">indiceAddress</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> receiver </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> c_opt </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Some</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> c</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token maybe-class-name">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">failwith</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;indice cannot send its value&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">contract</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    end</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> op </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> operation </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Tezos</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">transaction</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain">mutez</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> receiver</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> txs </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> list </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"> op</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">txs</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">execute</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> indiceVal </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> int</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> advisorFullReturn is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">result</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">algorithm</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">indiceVal</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">change</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> p </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorAlgo</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> s </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> advisorFullReturn is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">algorithm</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nil </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">advisorMain</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> ep </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorEntrypoints</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#e3116c">const</span><span class="token parameter"> store </span><span class="token parameter operator" style="color:rgb(0, 92, 197)">:</span><span class="token parameter"> advisorStorage</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> advisorFullReturn is</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">block </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> ret </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> advisorFullReturn </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> ep </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">ReceiveValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">execute</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">RequestValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">request</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">|</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">ChangeAlgorithm</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">-</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">change</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    end</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">with</span><span class="token plain"> ret</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="simulation-1"></a>Simulation<a class="hash-link" href="#simulation-1" title="Direct link to heading">#</a></h4><p>Let&#x27;s simulate the advisor contract with an initial storage of:<br>
<code>record[indiceAddress=(&quot;KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn&quot; : address); algorithm=(function(const i : int) is False); result=False]</code>.</p><p>Note that we here choose a simple algorithm function that is <code>function(const i : int) is False</code> therefore the saved result is <code>False</code> too.</p><p>Let&#x27;s simulate again with <code>ReceiveValue(5)</code> as an action.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo dry-run advisor.ligo advisorMain </span><span class="token string">&#x27;ReceiveValue(5)&#x27;</span><span class="token plain"> </span><span class="token string">&#x27;record[indiceAddress=(&quot;KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn&quot; : address); algorithm=(function(const i : int) is False); result=False];&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let&#x27;s simulate with <code>RequestValue(unit)</code> as an action.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo dry-run advisor.ligo advisorMain </span><span class="token string">&#x27;RequestValue(unit)&#x27;</span><span class="token plain"> </span><span class="token string">&#x27;record[indiceAddress=(&quot;KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn&quot; : address); algorithm=(function(const i : int) is False); result=False]&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let&#x27;s simulate with <code>ChangeAlgorithm(function(const i : int) is if i &lt; 10 then True else False)</code> as action.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo dry-run advisor.ligo advisorMain </span><span class="token string">&#x27;ReceiveValue(5)&#x27;</span><span class="token plain"> </span><span class="token string">&#x27;record[indiceAddress=(&quot;KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn&quot; : address); algorithm=(function(const i : int) is False); result=False]&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="compilation-1"></a>Compilation<a class="hash-link" href="#compilation-1" title="Direct link to heading">#</a></h4><p>Now, let&#x27;s prepare the parameters and the storage.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-parameter advisor.ligo advisorMain </span><span class="token string">&#x27;ReceiveValue(5)&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#output: (Left (Right 5))</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-parameter advisor.ligo advisorMain </span><span class="token string">&#x27;RequestValue(unit)&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#output: (Right Unit)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let&#x27;s say we want to change the algorithm, to a more interesting one but still use a simple business logic :
<em>if the indice of a stock (indice storage) is under 20, one should invest</em>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-parameter advisor.ligo advisorMain </span><span class="token string">&#x27;ChangeAlgorithm(function(const i : int) is if i &lt; 20 then True else False)&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#output: (Left (Left { PUSH int 20 ; SWAP ; COMPARE ; LT ; IF { PUSH bool True ] [ PUSH bool False } }))</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let&#x27;s compile the storage with a similar business logic as an initial state.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-storage advisor.ligo advisorMain </span><span class="token string">&#x27;record[indiceAddress=(&quot;KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn&quot; : address); algorithm=(function(const i : int) is if i &lt; 10 then True else False); result=False]&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This command should return:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Pair</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Pair</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> int </span><span class="token number">10</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">COMPARE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">LT</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">IF</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> bool </span><span class="token maybe-class-name">True</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> bool </span><span class="token maybe-class-name">False</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token string">&quot;KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token maybe-class-name">False</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Once everything looks ok, we can compile the main and save the output in a <code>advisor.tz</code> file.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ligo compile-contract advisor.ligo indiceMain </span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> advisor.tz</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This should return:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">parameter</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">lambda </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">changeAlgorithm int bool</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">int </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">receiveValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">requestValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">storage</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">pair</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">pair</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">lambda </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">algorithm int bool</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">address </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">indiceAddress</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">bool </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  code </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">DUP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         </span><span class="token constant" style="color:rgb(100, 102, 149)">CDR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         </span><span class="token constant" style="color:rgb(100, 102, 149)">CAR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         </span><span class="token constant" style="color:rgb(100, 102, 149)">IF_LEFT</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">IF_LEFT</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">               </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">DUP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">DUG</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">CDR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">DIG</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">CAR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">CDR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">DIG</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">NIL</span><span class="token plain"> operation </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">               </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">DUP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">DUG</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">CAR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">CAR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">EXEC</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">CAR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">NIL</span><span class="token plain"> operation </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">DROP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">DUP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">CAR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">CDR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">CONTRACT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">sendValue unit </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">IF_NONE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> string </span><span class="token string">&quot;indice cannot send its value&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">FAILWITH</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> mutez </span><span class="token number">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">UNIT</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">TRANSFER_TOKENS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">NIL</span><span class="token plain"> operation </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">DIG</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">CONS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="deployment-1"></a>Deployment<a class="hash-link" href="#deployment-1" title="Direct link to heading">#</a></h4><p>In the same way as the indice contract, let&#x27;s run the following command in a <code>--dry-run</code> mode.<br>
In the <code>--init</code> section we put the michelson result of the <code>compile-storage</code> that we just ran above.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client originate contract advisor transferring </span><span class="token number">1</span><span class="token plain"> from bootstrap1  running </span><span class="token string">&#x27;advisor.tz&#x27;</span><span class="token plain"> --init </span><span class="token string">&#x27;(Pair (Pair { PUSH int 10 ; SWAP ; COMPARE ; LT ; IF { PUSH bool True } { PUSH bool False } } &quot;KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn&quot;) False)&#x27;</span><span class="token plain"> --dry-run</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You should have an error message telling you to specify the gaz fee with <code>--burn-cap</code></p><p>Try again and if everything works properly run the same command without the <code>--dry-run</code> part.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client originate contract advisor transferring </span><span class="token number">1</span><span class="token plain"> from bootstrap1  running </span><span class="token string">&#x27;advisor.tz&#x27;</span><span class="token plain"> --init </span><span class="token string">&#x27;(Pair (Pair { PUSH int 10 ; SWAP ; COMPARE ; LT ; IF { PUSH bool True } { PUSH bool False } } &quot;KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn&quot;) False)&#x27;</span><span class="token plain"> --burn-cap </span><span class="token number">0.16825</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The transaction is now launched, and you should have the following response:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Node is boostrapped.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Estimated gas 3144,273 units (will add 100 + 112 for safety)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Estimated storage: 673 bytes added (will add 20 for safety)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Operation successfully injected in the node.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Operation hash is &#x27;opR766cSqn37L8qCjgcEqu4tfGeukCKBezpHjjicAYB4NYf6g2b&#x27;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Waiting for the operation to be included...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let&#x27;s open another initialized terminal in order to bake this transaction using the following command line:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client bake </span><span class="token keyword" style="color:#e3116c">for</span><span class="token plain"> bootstrap1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Now, run the command below and you can see your advisor contract on the list !</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client list known contracts</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">advisor: KT1FzbmriX7zNuKh6wTiRQidk9eyb7zFsk6c</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">indice: KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">activator: tz1TGu6TN5GSez2ndXXeDX6LgUDvLzPLqgYV</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap5: tz1ddb9NMYHZi5UzPdzTZMYQQZoMub195zgv</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap3: tz1b7tUupMgCNw2cCLpKTkSD1NZzB5TkP2sv</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap2: tz1faswCTDciRzE4oJ9jn2Vm2dvjeyA9fUzU</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">bootstrap1: tz1KqTpEZ7Yob7QbPE4Hy4Wo8fHG8LhKxZSx</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="use"></a>Use<a class="hash-link" href="#use" title="Direct link to heading">#</a></h3><p>Now that the two contracts are deployed we are able to use them.</p><p>You can run the following command to access the storage of the indicated contract.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client get contract storage </span><span class="token keyword" style="color:#e3116c">for</span><span class="token plain"> advisor</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This should return the same result as the <code>compile-storage</code> command because no transactions have yet been made.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Pair</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Pair</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> int </span><span class="token number">10</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">COMPARE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">LT</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">IF</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> bool </span><span class="token maybe-class-name">True</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> bool </span><span class="token maybe-class-name">False</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token string">&quot;KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token maybe-class-name">False</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let&#x27;s check for the indice contract as well.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client get contract storage </span><span class="token keyword" style="color:#e3116c">for</span><span class="token plain"> indice</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">//output: </span><span class="token number">0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Now, let&#x27;s do a transaction!</p><p>Imagine the user <strong>bootstrap3</strong> wants to use the advisor smart contract to know if he should invest.</p><p>For that, he must make a transaction using the action <code>RequestValue(Unit)</code> for which the michelson expression is <code>(Right Unit)</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client transfer </span><span class="token number">0</span><span class="token plain"> from bootstrap3 to advisor --arg </span><span class="token string">&#x27;(Right Unit)&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Then in another terminal let&#x27;s bake for <strong>bootstrap3</strong>,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client bake </span><span class="token keyword" style="color:#e3116c">for</span><span class="token plain"> bootstrap3</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Now let&#x27;s check if it&#x27;s worth the investment by looking at the storage</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">tezos-client get contract storage </span><span class="token keyword" style="color:#e3116c">for</span><span class="token plain"> advisor</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Pair</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Pair</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> int </span><span class="token number">10</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">COMPARE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">LT</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token constant" style="color:rgb(100, 102, 149)">IF</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> bool </span><span class="token maybe-class-name">True</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> bool </span><span class="token maybe-class-name">False</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token string">&quot;KT1D99kSAsGuLNmT1CAZWx51vgvJpzSQuoZn&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The result pass from <code>False</code> to <code>True</code> in the result field, if it is worth the investment.</p><p>However, this is the case because the initial value of the indice storage is currently <code>0</code>
and our algorithm will returns true if this value is under <code>10</code>.</p><p>Now, it is your turn to play with these two smart contracts by, for example, incrementing the indice storage or changing the advisor algorithm.</p><blockquote><p>Remember if you are not sure what you are doing add <code>--dry-run</code> at the end of the command line to see if everything is ok.</p></blockquote><p>To go further you can find the code with a video explanations of this <a href="https://github.com/frankhillard/ligo_tutorial_fundadvisor" target="_blank" rel="noopener noreferrer">Github</a>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/octo-technology/OpenTezos/tree/main/docs/ligo/examples.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-06-16T12:33:09.000Z" class="lastUpdatedDate_1WI_">6/16/2021</time> by <strong>frankhillard</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ligo/unit-testing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Unit Testing with PyTezos</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ligo/exam"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Exam ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#function" class="table-of-contents__link">Function</a></li><li><a href="#record" class="table-of-contents__link">Record</a></li><li><a href="#main-function" class="table-of-contents__link">Main function</a></li><li><a href="#option" class="table-of-contents__link">Option</a></li><li><a href="#the-fund-and-its-advisor" class="table-of-contents__link">The Fund and its advisor</a><ul><li><a href="#transaction-workflow" class="table-of-contents__link">Transaction workflow</a></li><li><a href="#lambda-pattern" class="table-of-contents__link">Lambda pattern</a></li></ul></li><li><a href="#requirement" class="table-of-contents__link">Requirement</a></li><li><a href="#sandboxed-mode" class="table-of-contents__link">Sandboxed mode</a><ul><li><a href="#run-a-sandboxed-node" class="table-of-contents__link">Run a sandboxed node</a></li><li><a href="#use-the-sandboxed-client" class="table-of-contents__link">Use the sandboxed client</a></li><li><a href="#activate-a-protocol" class="table-of-contents__link">Activate a protocol</a></li></ul></li><li><a href="#first-contract---indice" class="table-of-contents__link">First contract - Indice</a><ul><li><a href="#defining-storage-and-entrypoints" class="table-of-contents__link">Defining storage and entrypoints</a></li><li><a href="#defining-the-main-function" class="table-of-contents__link">Defining the main function</a></li><li><a href="#defining-the-entrypoints" class="table-of-contents__link">Defining the entrypoints</a></li></ul></li><li><a href="#second-contract---advisor" class="table-of-contents__link">Second contract - Advisor</a><ul><li><a href="#defining-storage-and-entrypoints-1" class="table-of-contents__link">Defining storage and entrypoints</a></li><li><a href="#defining-the-main-function-1" class="table-of-contents__link">Defining the main function</a></li><li><a href="#defining-the-entrypoints-1" class="table-of-contents__link">Defining the entrypoints</a></li></ul></li><li><a href="#dry-run-compilation-and-deployment" class="table-of-contents__link">Dry-run, compilation and deployment</a><ul><li><a href="#indice-contract" class="table-of-contents__link">Indice contract</a></li><li><a href="#advisor-contract" class="table-of-contents__link">Advisor contract</a></li><li><a href="#use" class="table-of-contents__link">Use</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2021 OpenTezos.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.972b4ff9.js"></script>
<script src="/assets/js/main.6ca66676.js"></script>
</body>
</html>