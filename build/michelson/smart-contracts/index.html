<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="OpenTezos Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="OpenTezos Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Smart Contracts | OpenTezos</title><meta data-react-helmet="true" property="og:url" content="https://opentezos.com/michelson/smart-contracts"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Smart Contracts | OpenTezos"><meta data-react-helmet="true" name="description" content="Smart contracts in Michelson"><meta data-react-helmet="true" property="og:description" content="Smart contracts in Michelson"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://opentezos.com/michelson/smart-contracts"><link data-react-helmet="true" rel="alternate" href="https://opentezos.com/michelson/smart-contracts" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://opentezos.com/michelson/smart-contracts" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.60c2ec83.css">
<link rel="preload" href="/assets/js/runtime~main.972b4ff9.js" as="script">
<link rel="preload" href="/assets/js/main.6ca66676.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-dark.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/octo-technology/OpenTezos/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT" style="margin-left:2px">üåô</span></div><div class="react-toggle-track-x"><span class="toggle_71bT" style="margin-left:1px">‚òÄÔ∏è</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-dark.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/octo-technology/OpenTezos/" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Welcome</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/">Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/paths">Paths</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Blockchain Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics/main-properties">Main properties of the first &quot;blockchain&quot;</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics/proof-of-work">Proof-of-work</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics/other-consensuses">Introduction to other consensus algorithms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics/smart-contracts">Smart Contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchain-basics/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tezos Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/smart-contracts">Smart contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/liquid-proof-of-stake">Liquid Proof-of-Stake</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/operations">Operations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/cli-and-rpc">CLI and RPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/governance-on-chain">Governance on-chain</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/history-of-amendments">History of amendments</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/economics-and-rewards">Economics and rewards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tezos-basics/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deploy a node</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node/set-up-a-node">Set-up a node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node/networks">What about networks?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node/to-go-further">To go further</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/deploy-a-node/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How to use an Explorer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/indexer-explained">How Indexers Work?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/available-tezos-indexers">Available Tezos Explorers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/tzstats-main-features">How to use the tzStats blockchain explorer?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/tzstats-smart-contract">Checkout your smart contract on TzStats</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/private-indexer">Private indexer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explorer/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">SmartPy</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/smartpy">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/smartpy/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/smartpy/write-contract-smartpy">Smart contract development with SmartPy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/smartpy/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">LIGO</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ligo">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ligo/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ligo/write-contracts-ligo">Smart contract development in PascaLIGO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ligo/language-basics">Language basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ligo/deploy-a-contract">Smart Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ligo/unit-testing">Unit Testing with PyTezos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ligo/examples">Examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ligo/exam">Exam</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ligo/take-away">Take Away</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Michelson</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/michelson">Introduction</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/michelson/smart-contracts">Smart Contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/michelson/tutorial">Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/michelson/examples">Examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/michelson/instructions-reference">Instructions Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/michelson/exam">Exam</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/michelson/take-away">Take away</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Build a Dapp</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/truffle_compilation_migration">Smart contract deployment with Truffle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/taquito">Taquito</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/temple">Temple Wallet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/basics">Build a dapp - basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/front_user_experience">Build a dapp - User Experience</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapp/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Baking</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baking">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baking/baking_explained">How baking works?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baking/reward">Rewards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baking/bakers_list">List of bakers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baking/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deploy Bakers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baker">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baker/cli-baker">CLI to become a baker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baker/delegating">Delegating</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baker/voting">Voting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/baker/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">DeFi</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/token-standards">Token Standards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/dexs">Decentralized Exchanges</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/wrapped-assets">Wrapped Assets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/cross-chain-swaps">Cross-chain Swaps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/oracles">On-chain Oracles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/stablecoins">Stablecoins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/synthetics">Synthetics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/lending">Lending and Flash Loans</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/defi/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Formal Verification</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/formal-verification">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/formal-verification/gadt-coq">Coq, GADT and Mi-Cho-Coq</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/formal-verification/modeling-theorem">Formal verification on smart contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/formal-verification/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Private Blockchain</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/private">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/private/exam">Exam</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How to contribute</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/report-issue">Report an issue</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/opentezos">Contribute to OpenTezos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/tezos-core">Contribute to the Tezos Core Protocol</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/grant">Receive a grant</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/baker">Become a baker or a delegator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contribute/exam">Exam</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Smart Contracts</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="smart-contracts-in-michelson"></a>Smart contracts in Michelson<a class="hash-link" href="#smart-contracts-in-michelson" title="Direct link to heading">#</a></h2><p>Michelson is a domain-specific language and is designed to implement smart contracts. On Tezos, smart contracts are made of three parts:</p><ul><li>the <strong>parameter</strong> of the smart contract which describes the possible invocations of the smart contract (also called <strong>entrypoints</strong>) and their related arguments.</li><li>the <strong>storage</strong>, i.e., the type definition of the persistent data structure associated with the smart contract.</li><li>the <strong>code</strong> of the smart contract, i.e., a sequence of instructions to be executed when invoking the smart contract.</li></ul><p>A smart contract is defined by these three parts (parameter, storage, code). An empty smart contract looks like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">parameter unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">storage unit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">code </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">CDR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">       </span><span class="token constant" style="color:rgb(100, 102, 149)">NIL</span><span class="token plain"> operation </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">       </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let us now dig deeper into each part.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="parameter-entrypoints"></a>Parameter (Entrypoints)<a class="hash-link" href="#parameter-entrypoints" title="Direct link to heading">#</a></h3><p>The <strong>parameter</strong> of the smart contract describes all possible invocations of the smart contract. An <strong>entrypoint</strong> is an invocable function of the smart contract and usually takes arguments. Each entrypoint has specific arguments and is composed of:</p><ul><li>the type definition of the expected argument of the entrypoint </li><li>the annotation (name) of the entrypoint</li></ul><p>The example below shows a simple smart contract implementing a counter (it is not meant to be understood yet but illustrates the three parts of the smart contract).</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">parameter</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nat </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nat </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">sub</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token keyword module" style="color:#e3116c">default</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  storage int </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  code </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">AMOUNT</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> mutez </span><span class="token number">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">ASSERT_CMPEQ</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">UNPAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         </span><span class="token constant" style="color:rgb(100, 102, 149)">IF_LEFT</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">IF_LEFT</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">ADD</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SWAP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SUB</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">DROP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">DROP</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PUSH</span><span class="token plain"> int </span><span class="token number">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         </span><span class="token constant" style="color:rgb(100, 102, 149)">NIL</span><span class="token plain"> operation </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PAIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Notice that the parameter describing possible invocations is defined as:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nat </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">nat </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token plain">sub</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">unit </span><span class="token operator" style="color:rgb(0, 92, 197)">%</span><span class="token keyword module" style="color:#e3116c">default</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>It has three possible invocations (add, sub, and default) specified in a single logical structure composed of <em>or</em> operators. Since <em>or</em> needs two operands, you have to nest them to include three or more invocations.</p><p><img src="/assets/images/michelson_entrypoint_or_example-e75998e31498c1d331fabc94ccda44e8.svg"></p><small class="figure">FIGURE 1: Representation of a nested _or_ structure  to specify three entrypoints</small><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="storage"></a>Storage<a class="hash-link" href="#storage" title="Direct link to heading">#</a></h3><p>The <strong>storage</strong> is a persistent memory space associated with the smart contract when it is deployed. The data structure of the storage is defined in the smart contract during the deployment phase.</p><p>Notice that, in our <em>Counter</em> contract above, the type definition that describes the storage is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  storage int </span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>In our case, it is only storing one integer number.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="code"></a>Code<a class="hash-link" href="#code" title="Direct link to heading">#</a></h3><p>The <strong>code</strong> of the smart contract is a sequence of Michelson instructions separated by semi-colons <code>;</code>.</p><p>We will look into this in more details in <a href="/michelson/instructions-reference">instructions</a> and <a href="/michelson/tutorial">tutorial</a> chapters, but before that, let&#x27;s have a quick overview of the Michelson language.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="michelson-overview"></a>Michelson overview<a class="hash-link" href="#michelson-overview" title="Direct link to heading">#</a></h2><p>The Michelson language is the reference language for Tezos smart contracts. It is a low-level <strong>stack-based</strong> language (definition below). It is also <strong>Turing-complete</strong>, meaning it has all the basic operations to read/write/compare values in-memory, has infinite memory (up to the maximun gas use), and has conditional operators (e.g., <em>if</em> and <em>switch</em>).</p><p>The Michelson language introduces data types for structuring data and instructions on these data types for manipulating data.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="stack-based-language"></a>Stack-based language<a class="hash-link" href="#stack-based-language" title="Direct link to heading">#</a></h3><p>Generally speaking, a <em>stack</em> data structure is a linear collection of elements that can be added or removed with <code>PUSH</code> and <code>POP</code> instructions. In the Michelson language, elements can be pushed to the top of the stack or removed from the top of the stack. This kind of stack is called LIFO (Last In First Out).</p><p><img src="/assets/images/michelson_stack_basics-43b0dbca7d570e3127707d2ed347c0a2.svg"></p><small class="figure">FIGURE 2: Illustration of a stack</small><p>In the <a href="/michelson/tutorial">next chapter</a>, we will look into basic stack manipulations powered by the Michelson language.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="static-typing"></a>Static typing<a class="hash-link" href="#static-typing" title="Direct link to heading">#</a></h3><p>The Michelson language is strongly typed. All data inserted into the stack must be typed, and operators manipulating these data must respect the typing rules.</p><p>The Michelson language introduces primitive types for modeling data and composite types allowing for complex data structure definitions. It also introduces particular types for smart contract modeling.</p><p>The Michelson language provides basic type support on numbers, sequence of characters, logical expressions, and timestamps:</p><ul><li><code>nat</code> represents a natural integer (e.g. 0, 3, 15)</li><li><code>int</code> represents a integer (e.g. -10, 2, 3)</li><li><code>string</code> represents a sequence of characters (e.g. &quot;Hello&quot;)</li><li><code>bool</code> represents a boolean value (e.g. True, False)</li><li><code>bytes</code> represents a sequence of bytes (octet)</li><li><code>unit</code> represents a non-specified type.</li><li><code>timestamp</code> represents a duration (e.g. NOW, 1571659294, &quot;2019-09-26T10:59:51Z&quot;; i.e. a string following the RFC3339 standard)</li></ul><p>Michelson also provides composite types for grouping properties:</p><ul><li><code>set</code> represents an unordered collection of elements. It preserves the uniqueness of elements inside the collection (e.g. { 2; 4; 5; 7})</li><li><code>list</code> represents an ordered collection of elements of the same type (e.g. { 2; 4; 5; 3; 5 })</li><li><code>map</code> represents an associative array formed of key-value elements (e.g. { Elt &quot;Hello&quot; 1 }) </li><li><code>big_map</code> is another representation of an associative array but can handle larger amounts of data</li><li><code>pair</code> represents a tuple of two elements (e.g., pair &quot;World&quot; 1).</li><li><code>option</code> is a predefined variant type used to express whether there is a value of some type or <em>none</em>.</li><li><code>or</code> is a variant type that can handle elements of different types.</li></ul><p>Finally, Michelson provides specific types for smart contract modeling:</p><ul><li><code>address</code> represents an identifier for a user account or a deployed smart contract (e.g., <em>tz1faswCTDciRzE4oJ9jn2Vm2dvjeyA9fUzU</em>)</li><li><code>mutez</code> represents the smallest quantity of the Tezos crypto-currency (1 tez = 1,000,000 mutez)</li><li><code>key</code> is a byte sequence representing a public key (e.g., <em>edpkuBknW28nW72KG6RoH...</em> )</li><li><code>key_hash</code> represents a hashed key using a standard hashing function such as SHA512 (e.g., a string in base58 encoded form <em>tz1KqTpEZ7Yob7QbPE4Hy...</em>)</li><li><code>signature</code> is a byte sequence representing a message signed by a public key (e.g., <em>spsig1PPUFZucuAQybs5w...</em>)</li><li><code>chain_id</code> represents the network identifer (e.g., <em>0x7a06a770</em>, <em>NetXynUjJNZm7wi</em>)</li><li><code>operation</code> represents a transaction</li><li><code>contract</code> represents a contract interface used for contract interaction</li></ul><p>We&#x27;ll see examples of usage in the next chapters.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="atomic-computation"></a>Atomic computation<a class="hash-link" href="#atomic-computation" title="Direct link to heading">#</a></h3><p>The Michelson language provides basic operations on these types:  </p><ul><li>numbers: addition, subtraction, multiplication, euclidean division, comparison</li><li>string: split, concatenation, comparison</li><li>crypto: standard hash function</li><li>collection: standard collection manipulation (create, insert, remove, access, modification) </li><li>currency: standard operations on XTZ crypto-currency</li><li>smart contract: contract interactions, transfer, invocation of smart contracts, delegation</li></ul><p>These instructions introduce basic programming concepts such as:</p><ul><li>conditional branching: The <code>IF</code> instruction family</li><li>repetitive processing: <code>LOOP</code>, <code>ITER</code>, <code>MAP</code> instructions</li><li><em>Lambda</em> functions: <code>LAMBDA</code> instruction</li><li>structuring data: <code>PAIR</code>, <code>UNPAIR</code>, <code>CAR</code>, <code>CDR</code>, <code>LEFT</code>, <code>RIGHT</code> instructions, and <code>list</code>, <code>map</code>, <code>set</code> composite types</li><li>contract communication: <code>CONTRACT</code>, <code>TRANSFER_TOKENS</code> instructions</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="gas-model"></a>Gas model<a class="hash-link" href="#gas-model" title="Direct link to heading">#</a></h3><p>A cost of execution (called <strong>gas</strong>) is associated with each Michelson instruction. This is the money that must be paid in order to execute the instructions. A maximun gas limit prevents the execution of infinite loop. </p><p>Adding more memory space to the smart contract storage also has a cost (for each allocated byte).</p><p>When invoking a smart contract, one must specify the maximun amount of gas that can be spent to execute the code.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="deployment---address-and-balance"></a>Deployment - Address and balance<a class="hash-link" href="#deployment---address-and-balance" title="Direct link to heading">#</a></h2><p>To be accessible to anyone on the Tezos network, a smart contract must be deployed. This deployment phase is called <strong>origination</strong>.</p><p>Tezos smart contracts have built-in internal information available once the smart contract has been deployed:</p><ul><li>its <strong>address</strong> of the smart contract, that is a unique identifier.</li><li>its <strong>balance</strong>, representing the quantity of XTZ owned by the smart contract.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="invocation-and-transaction-return-list-of-operations-storage"></a>Invocation and transaction return (list of operations, storage)<a class="hash-link" href="#invocation-and-transaction-return-list-of-operations-storage" title="Direct link to heading">#</a></h2><p>The <strong>invocation</strong> of a smart contract is an explicit call for executing the smart contract code. It requires a call parameter which is a tuple of two elements (<code>PAIR</code>) containing:</p><ul><li>the value of the entrypoint</li><li>the value of the storage (current storage state)</li></ul><p>The invocation of the smart contract is expected to produce a tuple of two elements (<code>PAIR</code>) containing:</p><ul><li>a list of operations (which are the new transactions generated by this invocation, if any).</li><li>the new storage state.</li></ul><p>The list of operations represents all of the impacts your contract will have on the rest of the Tezos blockchain. The new storage state represents the impact your invocation will have on the contract storage.</p><p>The diagram below describes the execution of an &quot;empty smart contract&quot; (as seen in the previous section). Although this contract does not modify anything, it still has respect the input and output formats. </p><p><img src="/assets/images/michelson_smartcontract_basics-1e6ca476f5a13cceedbda97b25b68ce8.svg"></p><small class="figure">FIGURE 3: Execution of `CDR ; NIL operation ; PAIR`</small><p>Notice that this script performs no modification on the blockchain. The storage is given as a parameter and returned modified.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="explicit-failure"></a>Explicit failure<a class="hash-link" href="#explicit-failure" title="Direct link to heading">#</a></h2><p>When invoking a smart contract, the execution of the sequence of instructions may successfully finish. In this case, the transaction is considered finalized. If the execution of the sequence of instructions stops before the end, the transaction is considered to be rejected. The following chapters will introduce the Michelson instruction <code>FAIL</code> which is responsible for throwing an error in case of failed execution.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/octo-technology/OpenTezos/tree/main/docs/michelson/smart-contracts.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-05-31T20:13:56.000Z" class="lastUpdatedDate_1WI_">5/31/2021</time> by <strong>AymericBethencourt</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/michelson"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Introduction</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/michelson/tutorial"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tutorial ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#smart-contracts-in-michelson" class="table-of-contents__link">Smart contracts in Michelson</a><ul><li><a href="#parameter-entrypoints" class="table-of-contents__link">Parameter (Entrypoints)</a></li><li><a href="#storage" class="table-of-contents__link">Storage</a></li><li><a href="#code" class="table-of-contents__link">Code</a></li></ul></li><li><a href="#michelson-overview" class="table-of-contents__link">Michelson overview</a><ul><li><a href="#stack-based-language" class="table-of-contents__link">Stack-based language</a></li><li><a href="#static-typing" class="table-of-contents__link">Static typing</a></li><li><a href="#atomic-computation" class="table-of-contents__link">Atomic computation</a></li><li><a href="#gas-model" class="table-of-contents__link">Gas model</a></li></ul></li><li><a href="#deployment---address-and-balance" class="table-of-contents__link">Deployment - Address and balance</a></li><li><a href="#invocation-and-transaction-return-list-of-operations-storage" class="table-of-contents__link">Invocation and transaction return (list of operations, storage)</a></li><li><a href="#explicit-failure" class="table-of-contents__link">Explicit failure</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2021 OpenTezos.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.972b4ff9.js"></script>
<script src="/assets/js/main.6ca66676.js"></script>
</body>
</html>